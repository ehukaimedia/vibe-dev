# Vibe Dev CI Fix: Jest Loading Wrong Mocks

## For You (Human Coordinator)

The GitHub Actions CI is failing because Jest is finding the compiled JavaScript mocks in the `dist` folder instead of the TypeScript mocks in `src`. All tests pass locally but fail in CI after the build step.

## For Claude Code - COPY THIS ENTIRE SECTION

```bash
cd /Users/ehukaimedia/Desktop/AI-Applications/Node/vibe-dev
git pull origin main

# The issue: Jest loads from dist after build
ls -la dist/src/__mocks__/ 2>/dev/null || echo "No dist mocks yet"

# Fix: Update jest.config.js to ignore dist folder
cat jest.config.js

# Add modulePathIgnorePatterns to existing config
cat > jest.config.js << 'EOF'
/** @type {import('jest').Config} */
export default {
  preset: 'ts-jest/presets/default-esm',
  testEnvironment: 'node',
  extensionsToTreatAsEsm: ['.ts'],
  moduleNameMapper: {
    '^(\\.{1,2}/.*)\\.js$': '$1',
  },
  transform: {
    '^.+\\.tsx?$': [
      'ts-jest',
      {
        useESM: true,
      },
    ],
  },
  testMatch: ['**/*.test.ts', '**/*.spec.ts'],
  testTimeout: 30000,
  collectCoverageFrom: [
    'src/**/*.ts',
    '!src/**/*.test.ts',
    '!src/**/*.spec.ts',
  ],
  modulePathIgnorePatterns: ['<rootDir>/dist/'],
};
EOF

# Test locally to ensure it still works
npm test

# Verify terminal tests still at 100%
npm test -- terminal.test.ts

# If all good, commit and push
git add jest.config.js
git commit -m "fix: prevent Jest from loading dist folder mocks

- Add modulePathIgnorePatterns to jest config
- Fixes CI/CD failures where Jest loads compiled JS mocks
- Ensures TypeScript mocks from src are used"

git push origin main

# Monitor the CI run
gh run list --repo ehukaimedia/vibe-dev --limit 1 --json databaseId,displayTitle
```